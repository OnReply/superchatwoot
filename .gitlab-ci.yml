stages:
  - build
  - deploy

build_w3b:
  stage: build
  image: docker:stable-git
  services:
    - docker:dind
  variables:
    DOCKER_DRIVER: overlay2
  artifacts:
    paths:
      - image_w3b.txt
  script:
    - sh ./scripts/build.sh w3b $HEROKU_TOKEN
  only:
    - tags

deploy_w3b:
  stage: deploy
  image: alpine:latest
  script:
    - sh ./scripts/deploy.sh w3b web $HEROKU_TOKEN
  only:
    - tags